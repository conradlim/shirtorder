<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="conradlim">
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/conradp04/tj-shirt-project/master/TJ-site/tjfav.png">
    <title> TJ's Shirt Cart </title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link href="css/modern-business.css" rel="stylesheet">

    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="css/reg-main.css" rel="stylesheet">
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        #deleteItem {
            background-color: #cbc9c9;
            color: whitesmoke;
        }

            #deleteItem:hover {
                background-color: darkred;
                color: white;
            }
    </style>
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <img id="logoTj" style="width:70%;margin-top:10px" src="photos/tj_logo_b.png">
                </div>
            </div>
            <div id="countDiv" style="margin-left:950px;margin-top:15px;">
                <a href="index.html" style="font-size:15px;font-weight:bold;margin-right:5px;color:#353333">HOME</a>
                <label style="font-weight:bold;font-size:15px;margin-left:20px" class="glyphicon glyphicon-shopping-cart"></label>&nbsp;
                <a href="tj_ShoppingCart.html">
                    <span id="countContainer" style="margin-left:-6px;padding:3px 3px;background-color:darkred;border:1px solid darkred;border-radius:25px;">
                        <span id="showCount" style="color:#fff;font-weight:bold;margin:3px 5px; "></span>
                    </span>
                </a>
            </div>

        </div>
        <hr />
    </nav>

    <div style="margin-top:85px">
        <h1>Shopping Cart</h1>
    </div>
    
    <form action="https://formspree.io/blancuriel@gmail.com" id="gForm" method="POST">
        <input id="form-subject" value="New Hawaiian Shirt Order" type="hidden">
        <div id="tblDiv" style="display:block;margin-top:10px;">
        </div>

        <h3 style="margin-top:50px;text-align:center;margin-left:-745px" id="altLabel">Alternative Choices</h3>
        <div id="tblAlternateDiv" style="display:block;margin-top:10px;">
        </div>
           
        <!-- Modal -->
        <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <p class="modal-title" style="font-weight:bold">CREW MEMBER INFORMATION</p>
                    </div>
                    <div class="modal-body">

                        <div style="text-align:center;">
                            <h3>Name:</h3>
                            <input id="form-name" name="Name" class="formField" required>
                            <h3>Email:</h3>
                            <input id="form-email" name="Email" class="formField" type="email" required>

                            <h3>Specify WCO or ECO:</h3>
                            <select id="form-office" name="Company" required>
                                <option>--</option>
                                <option value="West Coast Office">West Coast Office</option>
                                <option value="East Coast Office">East Coast Office</option>
                            </select>
                        </div>
                        <div id="btnDiv" style="margin:15px auto;text-align:right">

                            <button id="btnSubmit" class="btn btn-danger" type="Submit" onclick="validateFrm();" value="send" style="margin:30px auto 15px auto;">SUBMIT ORDER</button>&nbsp;            
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div id="messageDiv" style="display:block;margin:5px auto;width:25%">                         
                            <span id="cartMessages" style="text-align:center;display:block;font-family:'Arial';font-weight:bold;font-size:12px;color:darkred"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        




        <!--<div style="text-align:center;">
            <h3>Name:</h3>
            <input id="form-name" name="Name" class="formField" required>
            <h3>Email:</h3>
            <input id="form-email" name="Email" class="formField" type="email" required>

            <h3>Specify WCO or ECO:</h3>
            <select id="form-office" name="Company" required>
                <option>--</option>
                <option value="West Coast Office">West Coast Office</option>
                <option value="East Coast Office">East Coast Office</option>
            </select>
        </div>-->
        <br />
        <div id="btnDiv" style="margin:5px auto 10px auto;text-align:center">
         <!--    <hr /> -->
            <p>Please make sure to select 7 shirts and up to 3 alternative shirts.</p>
            
            <button id="btnSubmit" class="btn btn-danger" data-toggle="modal" data-target="#myModal" type="button" value="send" style="margin:30px auto 15px auto;">CHECK OUT</button>&nbsp;
            <button id="btnClear" class="btn btn-default" type="button" onclick="clearCart()" style="margin:30px auto 15px auto;">CLEAR CART</button>
        </div>
        
     

    </form>

    <!--<div id="messageDiv" style="display:block;margin:15px auto;width:25%">
        <span id="cartMessages" style="text-align:center;display:block;font-family:'Arial';font-weight:bold;font-size:26px;color:darkred"></span>
    </div>-->
    <button id="btnAlternate" class="btn" style="float:right;margin:30px auto 15px auto;visibility:hidden" disabled></button>
    <button id="btnAdd" class="btn" style="float:right;margin:30px auto 15px auto;visibility:hidden" disabled></button>

       
<div style="text-align:center">

<div style="1px dotted darkred;width:100%;height:1px;background-color: darkgray;margin-top:115px"></div>
<table style="margin-top:-5px">
    <tr><td>
        <p><a href='http://traderjoes.com'>www.traderjoes.com</a></p>
    </td>
        <td>
        <p><a href="index.html#contactF">contact us</a></p>
        </td>
    </tr>
</TABLE>
    

    </div>

    <script src="js/jquery.js"></script>
    <script src="js/contactform.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript">
        function loadCart() {
            shirtCart = JSON.parse(localStorage.getItem("CartItems"))
        }

        function showCartitems() {

            shirtCart = JSON.parse(localStorage.getItem("CartItems"))
            alternateCart = JSON.parse(localStorage.getItem("AlternateItems"))

            count = 1
            var tableDiv = document.getElementById("tblDiv")
            var header = new Array()
            header[0] = ""
            header[1] = "STYLE"
            header[2] = "COLOR"
            header[3] = "SIZE"
            header[4] = "TYPE"
            header[5] = "M/W"

            var html = "<table id='itemsInCart' style='border:1px solid gray;border-collapse:collapse;text-align:center'>";
            var insertString = ""

            for (var i = 0; i < header.length; i++) {
                html += "<th style='padding:10px 50px'>"
                html += header[i] + "</th>"
            }
            //Initial Cart
            for (var i = 0; i < shirtCart.length; i++) {
                html += "<tr>";
                html += "<td>" + "<button id='deleteItem' name='check' type='button' class='glyphicon glyphicon-remove' style='border-radius:5px;border:1px solid #f5f5f5;' onclick='return removeItem(this);false' value='" + shirtCart[i].id + "-" + shirtCart[i].name + " - " + shirtCart[i].color + " - " + shirtCart[i].size + " - " + shirtCart[i].type + " - " + shirtCart[i].gender + " - " + shirtCart[i].count + "' data-id='" + shirtCart[i].id + "' data-color='" + shirtCart[i].color + "'></button></td>";
                html += "<td>" + shirtCart[i].id + "-" + shirtCart[i].name + "</td>";
                html += "<td>" + shirtCart[i].color + "</td>";
                html += "<td>" + shirtCart[i].size + "</td>";
                html += "<td>" + shirtCart[i].type + "</td>";
                html += "<td>" + shirtCart[i].gender + "</td>"
                html += "</tr>";
            }
            html += ""
            html += "</table>";
            tableDiv.innerHTML = html;

            //Alternate Cart
            if (alternateCart.length > 0) {
                var tableDivTwo = document.getElementById("tblAlternateDiv")
                var tableTwo = document.createElement("TABLE")
                var tableBodyTwo = document.createElement('TBODY')
                tableTwo.appendChild(tableBodyTwo)
                var html = "<table id='itemsInCartTwo' style='border:1px solid gray;border-collapse:collapse;text-align:center'>";

                for (var i = 0; i < header.length; i++) {
                    html += "<th style='padding:10px 50px'>"
                    html += header[i] + "</th>"
                }
                for (var i = 0; i < alternateCart.length; i++) {
                    html += "<tr>";
                    html += "<td>" + "<button id='deleteItem' type='button' class='glyphicon glyphicon-remove' style='border-radius:5px;border:1px solid #f5f5f5;' href='#' onclick='return removeAlternateItem(this);' data-id='" + alternateCart[i].id + "' data-color='" + alternateCart[i].color + "'></button></td>";
                    html += "<td>A" + alternateCart[i].id + "-" + alternateCart[i].name + "</td>";
                    html += "<td>" + alternateCart[i].color + "</td>";
                    html += "<td>" + alternateCart[i].size + "</td>";
                    html += "<td>" + alternateCart[i].type + "</td>";
                    html += "<td>" + alternateCart[i].gender + "</td>"
                    html += "</tr>";
                }
                html += ""
                html += "</table>";
                tableDivTwo.innerHTML = html;
            }
            else {
                var altLabel = document.getElementById('altLabel')
                altLabel.innerHTML = ''
                tblAlternateDiv.innerHTML = ''
            }
        }


        var _comp = document.getElementById('form-office');
        var _rField = document.getElementsByClassName('formField')
        var errorTxt = document.getElementById('messageDiv');

        function validateFrm() {
            if (shirtCart.length == 0) {
                cartAlert('Please Add Items Before Submitting')
                return false
            }
            for (var i = 0; i < _rField.length; i++) {
                if (_rField[i].value == "") {
                    _rField[i].style.border = '1px solid darkred'
                    _rField[i].focus()
                    cartAlert('Fields Required')
                    return false
                }
                if (_comp.selectedIndex == 0) {
                    _comp.style.border = '1px solid darkred'
                    _comp.focus()
                    cartAlert('Please Select Office')
                    return false
                }
            }

            console.log("order submitted")
            submitCall()
        }

        function submitCall() {
            $.ajax({
                url: "https://formspree.io/blancuriel@gmail.com",
                method: "POST",
                success: function () {
                    window.location = "thank-you-pg.html"
                    clearCart()                    
                    console.log("Success")                    
                },
                error: function () {
                    cartAlert("SUBMIT FAIL  <a href='index.html#contactF'>contact us</a> " )
                    console.log("FAIL")
                },
                data: {
                    Name: document.getElementById('form-name').value,
                    Office: document.getElementById('form-office').value,
                    Email: document.getElementById('form-email').value,
                    _cc: document.getElementById('form-email').value,
                    _subject: document.getElementById('form-subject').value,
                     Cart: document.getElementById('tblDiv').innerText,
                    NOTICE: "Alternate Shirts Labeled By 'A'",
                    AlternateShirts: document.getElementById('tblAlternateDiv').innerText,
                },
                dataType: "json"
            });
        }

        showCartitems()
    </script>
</body>
</html>
